/****************************************
Action! v0.7.0 Adam Baldwin 
He robbed from the rich and he gave to the poor.
Stood up to the man and he gave him what for.
Our love for him now, ain't hard to explain,
The hero of Canton, the man they call Jayne!
https://github.com/designfrontier/Action 
****************************************/
!function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n?n:e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t){var n=function(e){"use strict";var t=e||{};return t.ajaxGet=function(e,t,n){var o=this,r=n||o.url,i=new XMLHttpRequest;i.onload=function(){var n=JSON.parse(this.responseText);this.status.match(/^[23][0-9][0-9]$/)?(o.emit(o.get("dataEvent"),n),"string"==typeof e?o.set(e,n):o.set(n),"function"==typeof t&&t.apply(o,[n])):this.status.match(/^[4][0-9][0-9]$/)||this.status.match(/^[5][0-9][0-9]$/)&&o.emit("global:error",new action.Error("http","Error in request",o))},i.onerror=function(e,t,n){o.emit("global:error",new action.Error("http","Error in request type: "+t,o,n))},i.open("get",r,!0),i.send()},t};t.exports=n},{}],2:[function(e,t){var n=function(e){"use strict";var t=e,n=[];return t.emitterId=Math.ceil(1e4*Math.random()),t.eventStore={},t.emit=function(e,t,n){var o=this,r="undefined"!=typeof n&&n?o.eventStore[e]:action.eventStore[e];"undefined"!=typeof r&&r.forEach(function(n){"undefined"!=typeof n.scope?n.call.apply(n.scope,[t,o.emitterId]):n.call(t,o.emitterId),n.once&&o.silence({eventName:e,scope:n.scope,handler:n.call,once:n.once,local:n.local})})},t.emitLocal=function(e,t){var n=this;n.emit(e,t,!0)},t.listen=function(e,t,o,r,i){var a,c,s=this,u=!0,l=e,f=t,d=o,p=i,y=r;"object"==typeof e&&(l=e.eventName,f=e.handler,d=e.scope,y="undefined"!=typeof e.once?e.once:!1,p="undefined"!=typeof e.local?e.local:!1),a="undefined"!=typeof p&&p?s.eventStore[l]:action.eventStore[l],c="undefined"!=typeof p&&p?s:action,"undefined"!=typeof a?(a.some(function(e){return e.call.toString()===f.toString()&&e.once===!1?(u=!1,!0):void 0}),u&&"undefined"!=typeof d?a.push({once:y,call:f,scope:d,local:p}):u&&a.push({once:y,call:f,local:p})):(c.eventStore[l]=[],c.eventStore[l].push("undefined"!=typeof d?{once:y,call:f,scope:d,local:p}:{once:y,call:f,local:p})),n.push({eventName:l,once:y,call:f,scope:d,local:p})},t.listenLocal=function(e,t,n,o){var r=this;"object"==typeof e?(e.local=!0,r.listen(e)):r.listen({eventName:e,handler:t,scope:n,once:o,local:!0})},t.listenOnce=function(e,t,n){var o=this;"object"==typeof e?(e.once=!0,o.listen(e)):o.listen({eventName:e,handler:t,scope:n,once:!0})},t.listenOnceLocal=function(e,t,n){var o=this;"object"==typeof e?(e.local=!0,e.once=!0,o.listen(e)):o.listen({eventName:e,handler:t,scope:n,local:!0,once:!0})},t.silence=function(e,t,n,o,r){var i,a=this,c=e,s=t,u=n,l=r,f=o;"object"==typeof e&&(c=e.eventName,s=e.handler,u=e.once,l=e.scope,f=e.local),i="undefined"!=typeof f&&f?a:action,"undefined"!=typeof i.eventStore[c]&&(i.eventStore[c]="undefined"!=typeof s?i.eventStore[c].filter(function(e){var t=!(s.toString()!==e.call.toString());return"undefined"!=typeof l?(t=!(!t||!l),"boolean"==typeof u&&(t=!(!t||u!==e.once))):"boolean"==typeof u&&(t=!(!t||e.once!==u)),!t}):[])},t.silenceLocal=function(e,t,n,o){var r=this;"object"==typeof e?(e.local=!0,r.silence(e)):r.silence({eventName:e,handler:t,once:n,scope:o,local:!0})},t.requiredEvent=function(e,t,n,o){var r=this,i=function(e,t){var n=e,o=t;return function(){var e,t=!0;if("undefined"!=typeof o[n]){o[n]=!0;for(e in o)t=t&&o[e];t&&(!r._triggeredStateReady||r._fireMultiple)&&(setTimeout(r.stateReady.apply(r),100),r._triggeredStateReady=!0)}}};r._fireMultiple="undefined"!=typeof o?o:!1,"undefined"==typeof r.stateEvents&&(r.stateEvents={}),"undefined"==typeof r._triggeredStateReady&&(r._triggeredStateReady=!1),r.stateEvents[e]=!1,r.listen(e,t,n),r.listen(e,i(e,r.stateEvents),r)},t.tearDown=function(){var e=this;n.forEach(function(t){e.silence(t),action.silence(t)})},"undefined"==typeof t.stateReady&&(t.stateReady=function(){console.log("ready!")}),t.listen("system:trace",function(e){var t=this;t.emitterId===e&&t.emit("system:addTraced",t)},t),"function"==typeof t.init&&t.init.apply(t),t};t.exports=n},{}],3:[function(e,t){var n=e("./action.events"),o=e("./action.utils"),r=e("./action.ajax"),i=function(e){"use strict";var t=o.compose(n,r),i={},a=[];return t.super={},t.get=function(e){return i[e]},t.set=function(e,t){var n,r=this;if("object"==typeof e)for(n in e)e.hasOwnProperty(n)&&("tearDown"!==n&&"fetch"!==n&&"save"!==n&&"function"!=typeof e[n]?("object"==typeof t?(i[e]=Array.isArray(e[n])?[]:{},o.clone(i[e],e[n])):i[n]=e[n],r.emitLocal("attribute:changed",n)):("function"!=typeof r[n]||r.super[n]||(r.super[n]=r[n].bind(r)),r[n]=e[n]));else"tearDown"!==e&&"fetch"!==e&&"save"!==e?("object"==typeof t?(i[e]=Array.isArray(t)?[]:{},o.clone(i[e],t)):i[e]=t,r.emitLocal("attribute:changed",e)):("function"==typeof r[e]&&(r.super[e]=r[e].bind(r)),r[e]=t)},t.flatten=function(){return i},t.toJSON=function(){return JSON.stringify(i)},t.fetch=function(e,t,n,r){var i=this,a=i.url,c=i.get("cacheLocal")&&action.useLocalCache&&!r;"undefined"!=typeof a?c?window.localforage.getItem(window.btoa(i.url),function(t){null===t?i.ajaxGet(e,function(e){var t=e,n=i.url;window.localforage.setItem(window.btoa(n),t,function(){})}):i.emit(i.get("dataEvent"),t)}):i.ajaxGet(e,t):(i.emit("global:error",new o.Error("http","No URL defined",i)),"function"==typeof n&&n.apply(i))},t.save=function(){var e=this,t=e.url,n=e.get("id"),r="undefined"==typeof n?"post":"put",i=new XMLHttpRequest;"undefined"!=typeof t?(i.onload=function(){200===this.status||302===this.status?(e.clearChanges(),e.set(data),e.emit(e.get("dataEvent"),data)):(500===this.status||400===this.status)&&e.emit("global:error",new o.Error("http","Error in request",e))},i.submittedData=e.flatten(),i.open(r,t,!0),i.send()):e.emit("global:error",new o.Error("http","No URL defined",e))},t.clearChanges=function(){a=[]},t.getChanges=function(){return a},t.clear=function(){i={}},t.super.tearDownEvents=t.tearDown,t.tearDown=function(){var e=this;e.super.tearDownEvents.apply(t),e.clear(),Object.getOwnPropertyNames(t).forEach(function(e){t[e]=void 0})},"undefined"!=typeof e.data&&(t.set(e.data),delete e.data),Object.getOwnPropertyNames(e).forEach(function(n){"undefined"!=typeof t[n]&&(t.super[n]=t[n]),t[n]=e[n]}),t.listenLocal("attribute:changed",function(e){a.push(e)},t),t.listen(t.get("requestEvent"),function(){this.fetch()},t),"function"==typeof t.init&&t.init.apply(t),t};t.exports=i},{"./action.ajax":1,"./action.events":2,"./action.utils":5}],4:[function(e,t){var n=e("./action.events"),o=function(){"use strict";var e=n({});return function(){var t=(document.querySelectorAll("a"),document);t.addEventListener("click",function(t){var n,o=t.target;if("a"===o.tagName.toLowerCase()){if(n=o.attributes.href.textContent,n.match(/http:/))return{};e.emit("state:change",n),t.preventDefault()}})}(),{}};t.exports=o},{"./action.events":2}],5:[function(e,t){var n=function(e,t,n,o){"use strict";return{type:e,message:t,createdBy:n,errorObject:o}},o=function(e,t){"use strict";var n=e,o=t;return"undefined"==typeof o&&(o=e,n={}),Object.getOwnPropertyNames(n).forEach(function(e){"length"!==e&&(n[e]=void 0)}),Object.getOwnPropertyNames(o).forEach(function(e){"object"==typeof o[e]?(n[e]=Array.isArray(o[e])?[]:{},action.clone(n[e],o[e])):n[e]=o[e]}),n},r=function(){"use strict";var e={},t=0,n={},o=this;for(t=0;t<arguments.length;t++)"object"!=typeof arguments[t]||Array.isArray(arguments[t])?"function"==typeof arguments[t]&&arguments[t].call(e,e):(n=arguments[t],Object.getOwnPropertyNames(n).forEach(function(t){e[t]="object"==typeof n[t]?o.clone(n[t]):n[t]}));return e};t.exports={Error:n,clone:o,compose:r}},{}],6:[function(e,t){var n=e("./action.model"),o=e("./action.utils"),r=function(e){"use strict";var t=this,r="function"==typeof e.stateReady,i=n(e),a=[];return"undefined"==typeof i.render?void t.emit("global:error",new o.Error("required param","render() is required for a view",t)):"undefined"==typeof i.templateId?void t.emit("global:error",new o.Error("required param","templateId is required for a view",t)):"undefined"==typeof i.dataId?void t.emit("global:error",new o.Error("required param","dataId is required for a view",t)):"undefined"==typeof i.viewId?void t.emit("global:error",new o.Error("required param","viewId is required for a view",t)):(r?i.super.stateReady=function(){i.render.apply(i)}:i.stateReady=function(){i.render.apply(i)},i.super.render=i.render,i.render=function(){i.super.render.apply(i),i.emit("rendered:"+i.viewId),a.forEach(function(e){i.emit("target:set:"+e.viewId,document.querySelector(e.selector))})},i.requiredEvent("data:set:"+i.dataId,function(e){this.set(e)},i,!0),i.requiredEvent("template:set:"+i.templateId,function(e){this.template=e},i,!0),i.getElement&&(i.requiredEvent("target:set:"+i.viewId,function(e){this.element=e}),i.listen("destroy:"+i.viewId,function(){this.destroy()},i)),"undefined"==typeof i.destroy&&(i.destroy=function(){this.tearDown(),a.forEach(function(e){this.emit("destroy:"+e.viewId)}),this.element.remove()}),i.registerChild=function(e,t){a.push({selector:t,viewId:e})},i.listChildren=function(){return a},i.save=function(){var e=this;e.getChanges().length>0&&(e.emit("data:changed:"+e.dataId,e.flatten()),e.clearChanges())},i.listen("state:change",function(e){var t=this;e===t.stateEvent||e.replace("/","")===t.stateEvent?(t.emit("template:get",t.templateId),t.emit("data:get:"+t.dataId)):"undefined"!=typeof t.element&&"none"!==t.elemtn.style.display&&(t.element.style.display="none")},i),i)};t.exports=r},{"./action.model":3,"./action.utils":5}],7:[function(e){var t=e("./action.events"),n=e("./action.view"),o=e("./action.model"),r=e("./action.utils"),i=e("./action.route"),a=e("./action.ajax");window.action={eventStore:{},eventMe:t,routeMe:i,viewMe:n,modelMe:o,clone:r.clone,compose:r.compose,Error:r.Error,ajaxMe:a,init:function(){"use strict";var e=this;e.listen("template:get",function(t){e.emit("template:set:"+t,e.templates[t])},e),e.listen("global:error",function(e){console.group("An Error occured in an object with emitterid: "+e.createdBy.emitterId),console.log("It was a "+e.type+"error."),"string"==typeof e.errorObject?(console.log("It says: "+e.errorObject),console.log("and: "+e.message)):console.log("It says: "+e.message),console.log("The Whole Enchilada (object that caused this mess):"),console.dir(e.createdBy),"function"==typeof e.createdBy.flatten&&(console.log("Just the Lettuce (attributes):"),console.dir(e.createdBy.flatten())),"object"==typeof e.errorObject&&(console.log("Oh look an Error Object!:"),console.dir(e.errorObject)),console.groupEnd()},e)}},window.action=t(window.action)},{"./action.ajax":1,"./action.events":2,"./action.model":3,"./action.route":4,"./action.utils":5,"./action.view":6}]},{},[7]);